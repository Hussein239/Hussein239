lua
-- Ø³ÙƒØ±ÙŠØ¨Øª ØªØ±Ø¬Ù…Ø© Ù…ØªÙ‚Ø¯Ù… Ù…Ø¹ Ù…ÙŠØ²Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©

local TranslationScript = {}

-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© ÙˆØ´Ø§Ù…Ù„Ø©
TranslationScript.Config = {
    -- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ±Ø¬Ù…Ø©
    TranslationSources = {
        "https://raw.githubusercontent.com/Hussein239/Hussein239/refs/heads/main/29999",
        "https://backup-translation-source.com/translations"
    },
    CacheLimit = 1000,  -- Ø²ÙŠØ§Ø¯Ø© Ø­Ø¯ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©
    RefreshInterval = 1800,  -- Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 30 Ø¯Ù‚ÙŠÙ‚Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø³Ø§Ø¹Ø©
    
    -- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
    Notifications = {
        StartupMessage = "ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­ ğŸŒ",
        DeveloperCredit = "Ù…Ø·ÙˆØ± Ø§Ù„Ø³ÙƒØ±Ø¨Øª / @BH_D1 ğŸ’»",
        ErrorMessage = "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ±Ø¬Ù…Ø© âš ï¸",
        
        Styles = {
            Font = Enum.Font.GothamBold,
            TextSize = 24,
            BackgroundColor = Color3.fromRGB(31, 41, 55),
            TextColor = Color3.fromRGB(255, 255, 255)
        }
    },
    
    -- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„ØªØ±Ø¬Ù…Ø©
    TranslationOptions = {
        EnableAutoDetect = true,  -- Ù…Ø­Ø§ÙˆÙ„Ø© ÙƒØ´Ù Ø§Ù„Ù„ØºØ© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
        PreferredLanguage = "ar",  -- Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…ÙØ¶Ù„Ø©
        FallbackLanguage = "en"   -- Ù„ØºØ© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
    },
    
    -- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†
    SecuritySettings = {
        EnableAntiTamper = true,  -- Ø­Ù…Ø§ÙŠØ© Ø¶Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        LogUnauthorizedChanges = true  -- ØªØ³Ø¬ÙŠÙ„ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
    }
}

-- Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
local TranslationManager = {}

-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
function TranslationManager:initializeCache()
    self.translationCache = setmetatable({}, {
        __mode = "v",  -- Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù…Ø³Ø­ Ø§Ù„Ø¹Ù†Ø§ØµØ± ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
        __index = function(t, k)
            -- ØªØªØ¨Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¹Ù†Ø§ØµØ±
            if rawget(t, k) then
                t[k].lastAccessed = os.time()
            end
            return rawget(t, k)
        end
    })
    self.cacheStats = {
        hits = 0,
        misses = 0,
        totalLookups = 0
    }
end

-- ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡
function TranslationManager:loadTranslations()
    local loadedSuccessfully = false
    
    for _, sourceUrl in ipairs(TranslationScript.Config.TranslationSources) do
        local success, result = pcall(function()
            return loadstring(game:HttpGet(sourceUrl))()
        end)
        
        if success and type(result) == "table" then
            self.translations = result
            loadedSuccessfully = true
            break
        end
    end
    
    return loadedSuccessfully
end

-- ØªØ±Ø¬Ù…Ø© Ù†Øµ Ù…ØªÙ‚Ø¯Ù…Ø©
function TranslationManager:translateText(originalText)
    -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†Øµ
    if not originalText or type(originalText) ~= "string" then
        return originalText
    end
    
    -- Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø©
    local translatedText = self.translations[originalText] 
        or self.translations[string.lower(originalText)] 
        or originalText
    
    return translatedText
end

-- Ù…Ø¯ÙŠØ± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØ·ÙˆØ±
local NotificationManager = {}

function NotificationManager:createAdvancedNotification(message, duration)
    local playerGui = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    local screenGui = Instance.new("ScreenGui", playerGui)
    screenGui.Name = "AdvancedNotificationV2"
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    local frame = Instance.new("Frame", screenGui)
    frame.Size = UDim2.new(0, 400, 0, 60)
    frame.Position = UDim2.new(0.5, -200, 0, 20)
    frame.BackgroundColor3 = TranslationScript.Config.Notifications.Styles.BackgroundColor
    frame.BackgroundTransparency = 0.3
    frame.BorderSizePixel = 0
    
    local cornerRadius = Instance.new("UICorner", frame)
    cornerRadius.CornerRadius = UDim.new(0, 12)
    
    local textLabel = Instance.new("TextLabel", frame)
    textLabel.Size = UDim2.new(1, -20, 1, -10)
    textLabel.Position = UDim2.new(0, 10, 0, 5)
    textLabel.BackgroundTransparency = 1
    textLabel.Font = TranslationScript.Config.Notifications.Styles.Font
    textLabel.TextSize = TranslationScript.Config.Notifications.Styles.TextSize
    textLabel.TextColor3 = TranslationScript.Config.Notifications.Styles.TextColor
    textLabel.Text = message
    textLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    -- Ø±Ø³Ù… Ø§Ù„ØªØ£Ø«ÙŠØ±
    task.delay(duration, function()
        local tween = game:GetService("TweenService"):Create(frame, 
            TweenInfo.new(1), {BackgroundTransparency = 1, Position = frame.Position + UDim2.new(0, 0, 0, -50)})
        tween:Play()
        
        task.delay(1, function()
            screenGui:Destroy()
        end)
    end)
end

-- Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
local function monitorTextObjects(container)
    for _, object in ipairs(container:GetDescendants()) do
        if object:IsA("TextLabel") or object:IsA("TextButton") or object:IsA("TextBox") then
            -- Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ
            pcall(function()
                local translatedText = TranslationManager:translateText(object.Text)
                if translatedText and translatedText ~= object.Text then
                    object.Text = translatedText
                end
            end)
            
            -- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
            object:GetPropertyChangedSignal("Text"):Connect(function()
                pcall(function()
                    local translated = TranslationManager:translateText(object.Text)
                    if object.Text ~= translated then
                        object.Text = translated
                    end
                end)
            end)
        end
    end
end

-- Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
local LogManager = {
    logs = {},
    maxLogs = 100
}

function LogManager:addLog(logType, message)
    local log = {
        type = logType,
        message = message,
        timestamp = os.time()
    }
    
    table.insert(self.logs, log)
    
    -- ØªÙ‚Ù„ÙŠÙ… Ø§Ù„Ø³Ø¬Ù„Ø§Øª
    if #self.logs > self.maxLogs then
        table.remove(self.logs, 1)
    end
end

-- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
local function initializeTranslationScript()
    -- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
    TranslationManager:initializeCache()
    
    -- Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª
    local translationsLoaded = TranslationManager:loadTranslations()
    
    if translationsLoaded then
        -- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª
        monitorTextObjects(workspace)
        
        -- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
        game.Players.PlayerAdded:Connect(function(player)
            local playerGui = player:WaitForChild("PlayerGui")
            monitorTextObjects(playerGui)
        end)
        
        -- Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
        NotificationManager:createAdvancedNotification(
            TranslationScript.Config.Notifications.StartupMessage, 
            5
        )
        
        -- Ø¥Ø´Ø¹Ø§Ø± Ø¯ÙˆØ±ÙŠ Ù„Ù„Ù…Ø·ÙˆØ±
        task.spawn(function()
            while true do
                task.wait(1200)  -- ÙƒÙ„ 20 Ø¯Ù‚ÙŠÙ‚Ø©
                NotificationManager:createAdvancedNotification(
                    TranslationScript.Config.Notifications.DeveloperCredit, 
                    6
                )
            end
        end)
        
        -- ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø¯ÙˆØ±ÙŠÙ‹Ø§
        task.spawn(function()
            while true do
                task.wait(TranslationScript.Config.RefreshInterval)
                TranslationManager:loadTranslations()
                
                -- ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ø¯ÙŠØ«
                LogManager:addLog("RefreshTranslations", "ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø¨Ù†Ø¬Ø§Ø­")
            end
        end)
    else
        -- Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø®Ø·Ø£
        NotificationManager:createAdvancedNotification(
            TranslationScript.Config.Notifications.ErrorMessage, 
            5
        )
        
        -- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø·Ø£
        LogManager:addLog("LoadError", "ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµØ§Ø¯Ø±")
    end
end

-- ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª
initializeTranslationScript()

-- ÙˆØ§Ø¬Ù‡Ø© Ù„Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
TranslationScript.GetLogs = function()
    return LogManager.logs
end

TranslationScript.ReloadTranslations = function()
    return TranslationManager:loadTranslations()
end

-- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„ÙƒØ§Ø¦Ù† Ù„Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
return TranslationScript
